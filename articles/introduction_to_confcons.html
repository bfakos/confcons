<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="confcons">
<title>Introduction to package 'confcons' • confcons</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to package 'confcons'">
<meta property="og:description" content="confcons">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">confcons</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction_to_confcons.html">Introduction to package 'confcons'</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bfakos/confcons/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="introduction_to_confcons_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to package 'confcons'</h1>
                        <h4 data-toc-skip class="author">Ákos Bede-Fazekas, Imelda Somodi</h4>
            
            <h4 data-toc-skip class="date">2021-12-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bfakos/confcons/blob/HEAD/vignettes/introduction_to_confcons.Rmd" class="external-link"><code>vignettes/introduction_to_confcons.Rmd</code></a></small>
      <div class="d-none name"><code>introduction_to_confcons.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="confidence-and-consistence-what-are-they-and-why-using-them">Confidence and consistence: what are they and why using them?<a class="anchor" aria-label="anchor" href="#confidence-and-consistence-what-are-they-and-why-using-them"></a>
</h2>
<p>‘confcons’ (<strong>conf</strong>idence &amp; <strong>cons</strong>istence) is a light-weight, stand-alone R package designed to calculate the following two novel measures of predictive/potential distribution models (incl. species distribution models):</p>
<ul>
<li>
<em>confidence</em> that measures the proportion of predictions that the model is confident in;</li>
<li>
<em>consistence</em> that measures how consistent the model is if the confidence in the training and evaluation subsets are compared.</li>
</ul>
<p>While <em>confidence</em> serves as a replacement for the widely criticized goodness-of-fit measures, such as AUC, <em>consistence</em> is a proxy for model’s transferability (in space and time). Both measures can be calculated</p>
<ul>
<li>in a balanced way, when predicted presences and predicted absences are equally important. These measures are called <em>confidence in predictions</em> (‘CP’) and <em>consistence of</em> (or difference in confidences in) <em>predictions</em> (‘DCP’);</li>
<li>in a way weighted towards the predicted presences, when certain positive presences are more important for the selected modelling purpose. These measures are called <em>confidence in positive predictions</em> (‘CPP’) and <em>consistence of</em> (or difference in confidences in) <em>positive predictions</em> (‘DCPP’).</li>
</ul>
<p>A manuscript about the novel measures is submitted to a scientific journal. Once accepted, we’ll cite it here, and you’ll get much more information about the measures from that paper.</p>
</div>
<div class="section level2">
<h2 id="functions-for-calculating-confidence-and-consistence">Functions for calculating confidence and consistence<a class="anchor" aria-label="anchor" href="#functions-for-calculating-confidence-and-consistence"></a>
</h2>
<p>Three small functions, <code><a href="../reference/thresholds.html">thresholds()</a></code>, <code><a href="../reference/confidence.html">confidence()</a></code> and <code><a href="../reference/consistence.html">consistence()</a></code>, belong to the core of the package. A wrapper function called <code><a href="../reference/measures.html">measures()</a></code> utilizes these workhorse functions and calculates every measures for you optionally along with some traditional measures, such as AUC and maxTSS.</p>
<p>In the example below we’ll see how these function work and what are their parameters and returned value. For further details, please consult with the help page of the selected function and the examples given there.</p>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Here, we’ll go through the main steps of a typical workflow by:</p>
<ul>
<li>loading some environmental and presence-absence data using the example dataset of package ‘blockCV’;</li>
<li>splitting the dataset to training and evaluation subset using spatial blocks;</li>
<li>training some simple models on the training subset;</li>
<li>making predictions to the whole dataset;</li>
<li>evaluating our models and</li>
<li>interpreting the measures returned by <code><a href="../reference/measures.html">confcons::measures()</a></code>.</li>
</ul>
<p>First, we install package ‘confcons’ and their dependencies needed for this tutorial (incl. ‘raster’, ‘sf’, ‘blockCV’, ‘ranger’ and ‘ROCR’):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"bfakos/confcons"</span>, upgrade <span class="op">=</span> <span class="st">"never"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>If installed, we can attach these packages to the R session (and suppress the not too important warnings about the R version under the packages were built):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: sp</span>
<span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1</span>
<span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rvalavi/blockCV" class="external-link">blockCV</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/imbs-hl/ranger" class="external-link">ranger</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ipa-tys.github.io/ROCR/" class="external-link">ROCR</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bfakos/confcons" class="external-link">confcons</a></span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-preparation">Data preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<p>Let’s open the environmental raster that contains eight climatic and two topographic layers at 800 m resolution in UTM projection:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">environment</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html" class="external-link">brick</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"awt.grd"</span>, package <span class="op">=</span> <span class="st">"blockCV"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/nlayers.html" class="external-link">nlayers</a></span><span class="op">(</span><span class="va">environment</span><span class="op">)</span>
<span class="co">#&gt; [1] 10</span>
<span class="op">(</span><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">environment</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  [1] "bc01"  "bc04"  "bc05"  "bc06"  "bc12"  "bc17"  "bc20"  "bc33"  "slope"</span>
<span class="co">#&gt; [10] "topo"</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html" class="external-link">proj4string</a></span><span class="op">(</span><span class="va">environment</span><span class="op">)</span>
<span class="co">#&gt; [1] "+proj=utm +zone=55 +south +datum=WGS84 +units=m +no_defs"</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/resolution.html" class="external-link">res</a></span><span class="op">(</span><span class="va">environment</span><span class="op">)</span>
<span class="co">#&gt; [1] 800 800</span></code></pre></div>
<p>We open also the occurrence data from a .csv file and convert them to Simple Features:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">occurrences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"PA.csv"</span>, package <span class="op">=</span> <span class="st">"blockCV"</span><span class="op">)</span><span class="op">)</span>
<span class="va">occurrences</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">occurrences</span>,
                            coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>,
                            crs <span class="op">=</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/projection.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">environment</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>For further details on the dataset, please refer to <a href="http://htmlpreview.github.io/?https://github.com/rvalavi/blockCV/blob/master/vignettes/BlockCV_for_SDM.html" class="external-link">this</a> vignette.</p>
<p>Now we split the study region to training and evaluation parts using random spatial blocks and convert the resulted blocks to Simple Features:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">blocks</span> <span class="op">&lt;-</span> <span class="fu">blockCV</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/blockCV/man/spatialBlock.html" class="external-link">spatialBlock</a></span><span class="op">(</span>speciesData <span class="op">=</span> <span class="va">occurrences</span>,
                                species <span class="op">=</span> <span class="st">"Species"</span>,
                                rasterLayer <span class="op">=</span> <span class="va">environment</span>,
                                theRange <span class="op">=</span> <span class="fl">50000</span>,
                                k <span class="op">=</span> <span class="fl">2</span>,
                                selection <span class="op">=</span> <span class="st">"random"</span>,
                                showBlocks <span class="op">=</span> <span class="cn">FALSE</span>,
                                seed <span class="op">=</span> <span class="fl">12345</span>,
                                progress <span class="op">=</span> <span class="cn">FALSE</span>,
                                verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">blocks_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">blocks</span><span class="op">$</span><span class="va">blocks</span><span class="op">)</span></code></pre></div>
<p>Let’s see where are our presence and absence points and also which polygons will be used for training and which ones for evaluation:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">environment</span><span class="op">[[</span><span class="st">"bc01"</span><span class="op">]</span><span class="op">]</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">cm.colors</a></span><span class="op">(</span><span class="fl">255</span><span class="op">)</span>, colNA <span class="op">=</span> <span class="st">"gray95"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">occurrences</span><span class="op">[</span><span class="va">occurrences</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span>, pch <span class="op">=</span> <span class="st">"+"</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">occurrences</span><span class="op">[</span><span class="va">occurrences</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="fl">0</span>, <span class="op">]</span>, pch <span class="op">=</span> <span class="st">"+"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">blocks_sf</span><span class="op">[</span><span class="va">blocks_sf</span><span class="op">$</span><span class="va">folds</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"transparent"</span>, border <span class="op">=</span> <span class="st">"#2222DD66"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">blocks_sf</span><span class="op">[</span><span class="va">blocks_sf</span><span class="op">$</span><span class="va">folds</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"transparent"</span>, border <span class="op">=</span> <span class="st">"#DD222266"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">140000</span>,
       y <span class="op">=</span> <span class="fl">8000000</span>,
       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"presence"</span>, <span class="st">"absence"</span>, <span class="st">"training"</span>, <span class="st">"evaluation"</span><span class="op">)</span>,
       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"orange"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,
       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="st">"+"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,
       border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"#2222DD66"</span>, <span class="st">"#DD222266"</span><span class="op">)</span>,
       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"transparent"</span>, <span class="st">"transparent"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_to_confcons_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>We start to build a <code>data.frame</code> that will contain</p>
<ul>
<li>the predictor values in the presence and absence locations,</li>
<li>the observed occurrences,</li>
<li>the training mask (<code>TRUE</code> for the location later used for model training, <code>FALSE</code> for evaluation locations), and</li>
<li>the predicted probabilities of occurrence (latter appended).</li>
</ul>
<p><code>raster::extraxt()</code> gathers the predictors from the studied locations for us. <code>blocks$folds[[1]]</code> contains two vectors of indices. We’ll use the first vector for training (and the second one for evaluation).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extract.html" class="external-link">extract</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">environment</span>,
                           y <span class="op">=</span> <span class="va">occurrences</span>,
                           df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span> <span class="op">&lt;-</span> <span class="va">occurrences</span><span class="op">$</span><span class="va">Species</span>
<span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">occurrences</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/raster/man/match.html" class="external-link">%in%</a></span> <span class="va">blocks</span><span class="op">$</span><span class="va">folds</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    254 obs. of  13 variables:</span>
<span class="co">#&gt;  $ ID           : num  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ bc01         : num  20 20 20 18 20 20 21 20 20 21 ...</span>
<span class="co">#&gt;  $ bc04         : num  100 98 93 97 102 102 94 111 95 110 ...</span>
<span class="co">#&gt;  $ bc05         : num  28 29 28 26 28 29 29 29 28 29 ...</span>
<span class="co">#&gt;  $ bc06         : num  10 10 11 10 10 10 12 11 11 11 ...</span>
<span class="co">#&gt;  $ bc12         : num  30 25 19 26 26 24 34 16 23 15 ...</span>
<span class="co">#&gt;  $ bc17         : num  27 21 12 20 23 21 28 8 18 7 ...</span>
<span class="co">#&gt;  $ bc20         : num  180 182 188 183 182 183 179 192 184 192 ...</span>
<span class="co">#&gt;  $ bc33         : num  85 69 39 64 78 73 79 26 56 23 ...</span>
<span class="co">#&gt;  $ slope        : num  16 10 12 20 10 7 35 3 7 22 ...</span>
<span class="co">#&gt;  $ topo         : num  35 44 66 55 49 46 39 53 62 55 ...</span>
<span class="co">#&gt;  $ occurrences  : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ training_mask: logi  FALSE FALSE TRUE FALSE FALSE FALSE ...</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="training-models-and-making-predictions">Training models and making predictions<a class="anchor" aria-label="anchor" href="#training-models-and-making-predictions"></a>
</h3>
<p>Now the <code>data.frame</code> contains all of the information needed to train predictive distribution models. For the sake of this example, we will create two simple models:</p>
<ul>
<li>a Generalized Linear Model (GLM) with a linear formula (i.e., without interactions) and stepwise predictor selection, and</li>
<li>a Random Forest (RF) model with 1000, 3-level trees.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">linear_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"occurrences ~ "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">predictors</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">model_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/step.html" class="external-link">step</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="fl">0</span>,
                  object <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">linear_formula</span>,
                               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,
                               data <span class="op">=</span> <span class="va">dataset</span><span class="op">[</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">dataset</span><span class="op">$</span><span class="va">predictions_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model_glm</span>,
                                   newdata <span class="op">=</span> <span class="va">dataset</span>,
                                   type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></code></pre></div>
<p>The GLM model was trained on the training subset (<code>dataset[dataset$training_mask, ]</code>) but all of the studied locations were used for prediction (i.e. training and evaluation subsets). A new column called ‘predictions_glm’ was append to the <code>data.frame</code>. We repeat the same procedure, now training the RF model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_rf</span> <span class="op">&lt;-</span> <span class="fu">ranger</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ranger/man/ranger.html" class="external-link">ranger</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">linear_formula</span>,
                           data <span class="op">=</span> <span class="va">dataset</span><span class="op">[</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span>, <span class="op">]</span>,
                           num.trees <span class="op">=</span> <span class="fl">1000</span>,
                           min.node.size <span class="op">=</span> <span class="fl">10</span>,
                           max.depth <span class="op">=</span> <span class="fl">3</span>,
                           verbose <span class="op">=</span> <span class="cn">FALSE</span>,
                           classification <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">dataset</span><span class="op">$</span><span class="va">predictions_rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">model_rf</span>,
                                  data <span class="op">=</span> <span class="va">dataset</span>,
                                  type <span class="op">=</span> <span class="st">"response"</span>,
                                  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">predictions</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"occurrences"</span>, <span class="st">"training_mask"</span>, <span class="st">"predictions_glm"</span>, <span class="st">"predictions_rf"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    254 obs. of  4 variables:</span>
<span class="co">#&gt;  $ occurrences    : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ training_mask  : logi  FALSE FALSE TRUE FALSE FALSE FALSE ...</span>
<span class="co">#&gt;  $ predictions_glm: num  0.934 0.981 0.916 0.996 0.908 ...</span>
<span class="co">#&gt;  $ predictions_rf : num  0.875 0.918 0.856 0.902 0.905 ...</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="evaluation-and-interpretation">Evaluation and interpretation<a class="anchor" aria-label="anchor" href="#evaluation-and-interpretation"></a>
</h3>
<p>Models are trained, predictions are done, so one step is missing: the evaluation. This is where package ‘confcons’ will become useful…</p>
<p>Let’s take a look at the lower (mean predicted value in the absence locations) and upper (mean predicted value in the presence locations) thresholds below/above which we interpret the predicted values as certain negatives and certain positives, respectively. We use function <code><a href="../reference/thresholds.html">thresholds()</a></code> for this purpose, which needs the integer/logical vector of the observed predictions (called ‘observations’) and the numeric vector of the predicted probabilities of occurrence (called ‘predictions’) as input parameters. The function returns two values (i.e., a named numeric vector of length 2).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">thresholds_glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thresholds.html">thresholds</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span>,
                              predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_glm</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; threshold1 threshold2 </span>
<span class="co">#&gt;  0.1438731  0.8179655</span>
<span class="op">(</span><span class="va">thresholds_rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thresholds.html">thresholds</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span>,
                             predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_rf</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; threshold1 threshold2 </span>
<span class="co">#&gt;  0.1823275  0.7732901</span></code></pre></div>
<p>Between 0.14 and 0.82, the predictions of the GLM model can be treated as uncertain predictions. The same holds for the RF model between 0.18 and 0.77.</p>
<p>Now we calculate two of the proposed evaluation measures, confidence in positive predictions (CPP) and confidence in predictions (CP). Both should be calculated using the evaluation subset. Function <code><a href="../reference/confidence.html">confidence()</a></code> can calculate both measures, depending on the value of its parameter ‘type’. If it’s ‘positive’, we’ll get CPP, if it’s ‘neutral’, we’ll get CP that is not weighted towards the positive predictions. Beyond ‘type’ and the two previously mentioned parameters (‘observations’ and ‘predictions’) one more parameter is needed: ‘thresholds’. Of course, the previously calculated thresholds will perfectly suits for this purpose.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conf_P_eval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence.html">confidence</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span><span class="op">[</span><span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span><span class="op">]</span>,
                          predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_glm</span><span class="op">[</span><span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span><span class="op">]</span>,
                          thresholds <span class="op">=</span> <span class="va">thresholds_glm</span>,
                          type <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span>
<span class="va">conf_P_eval</span>
<span class="co">#&gt; [1] 0.7407407</span>
<span class="va">conf_N_eval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence.html">confidence</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span><span class="op">[</span><span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span><span class="op">]</span>,
                          predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_glm</span><span class="op">[</span><span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span><span class="op">]</span>,
                          thresholds <span class="op">=</span> <span class="va">thresholds_glm</span>,
                          type <span class="op">=</span> <span class="st">"neutral"</span><span class="op">)</span>
<span class="va">conf_N_eval</span>
<span class="co">#&gt; [1] 0.7586207</span></code></pre></div>
<p>There is not so much difference between the two measures. Whether we should use CPP or CP for describing the confidence of our model depends on the main aim of our model. Confidence should be between <code>0</code> and <code>1</code>; the higher value indicates more confidence. Our GLM is not super confident, but the value is closer to <code>1</code>, so it seems more or less OK.</p>
<p>We are a bit curios whether the confidence of the model is higher or lower if is calculated for the training subset.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conf_P_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/confidence.html">confidence</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span><span class="op">[</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span><span class="op">]</span>,
                           predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_glm</span><span class="op">[</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span><span class="op">]</span>,
                           thresholds <span class="op">=</span> <span class="va">thresholds_glm</span>,
                           type <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span>
<span class="va">conf_P_train</span>
<span class="co">#&gt; [1] 0.7719298</span>
<span class="va">conf_P_eval</span> <span class="op">&lt;</span> <span class="va">conf_P_train</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Of course, the model is more confident in the training subset than in the evaluation subset. This is absolutely normal (and would be strange if the opposite occurs). Which is not evident is the difference between the two and its interpretation. <code><a href="../reference/consistence.html">consistence()</a></code> is the function that do the magic for us: a simple subtraction… It needs one of the two confidence measures (CPP or CP) for the training and the evaluation dataset, and returns their difference.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/consistence.html">consistence</a></span><span class="op">(</span>conf_train <span class="op">=</span> <span class="va">conf_P_train</span>, conf_eval <span class="op">=</span> <span class="va">conf_P_eval</span><span class="op">)</span>
<span class="co">#&gt; [1] -0.03118908</span></code></pre></div>
<p>A negative value between <code>-1</code> and <code>0</code> is normal. The higher the consistence is (i.e., the closer to <code>0</code>), the more consistent the model is. Positive value might be an artifact or indicates that the training and evaluation subsets were accidentally swapped.</p>
<p>Now we get familiar with the three core functions of the package: <code><a href="../reference/thresholds.html">thresholds()</a></code>, <code><a href="../reference/confidence.html">confidence()</a></code> and <code><a href="../reference/consistence.html">consistence()</a></code>. Your question is right if you ask: <em>why should I call three different functions several times if I want to get all the measures for my model?</em>. Well, you don’t have to. There is a wrapper function called <code><a href="../reference/measures.html">measures()</a></code> that calculates everything for you.</p>
<p>It needs three vectors:</p>
<ul>
<li>the <code>integer</code>/<code>logical</code> vector of observed occurrences (‘observations’),</li>
<li>the <code>numeric</code> vector of predicted probabilities of occurrence (‘predictions’), and</li>
<li>the <code>logical</code> mask of the evaluation locations (‘evaluation_mask’).</li>
</ul>
<p>Previously we calculated the mask of the training locations, so its negation (<code>!</code>) will perfectly match this purpose:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/measures.html">measures</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span>,
         predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_glm</span>,
         evaluation_mask <span class="op">=</span> <span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span><span class="op">)</span>
<span class="co">#&gt;    CP_train     CP_eval         DCP   CPP_train    CPP_eval        DCPP </span>
<span class="co">#&gt;  0.77586207  0.75862069 -0.01724138  0.77192982  0.74074074 -0.03118908</span>
<span class="fu"><a href="../reference/measures.html">measures</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span>,
         predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_rf</span>,
         evaluation_mask <span class="op">=</span> <span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span><span class="op">)</span>
<span class="co">#&gt;   CP_train    CP_eval        DCP  CPP_train   CPP_eval       DCPP </span>
<span class="co">#&gt;  0.8620690  0.6724138 -0.1896552  0.8620690  0.6415094 -0.2205595</span></code></pre></div>
<p>The result is a named <code>numeric</code> vector containing all of the measures. It is more than needed. I recommend you to use ‘CPP_eval’ + ‘DCPP’, or, if predicted absences are as important as predicted presences in your research, use ‘CP_eval’ + ‘DCP’.</p>
<p>We can see that RF model is really confident in its predictions if the training subset is studied, but this confidence sharply drops when switching to the evaluation subset. Hence, the RF model is not too consistent, which warns us that transferability issues might potentially occurs if used for extrapolation. The GLM model is much more consistent, so if I were you, I would select that one for extrapolation, e.g. in a climate change impact study!</p>
<p>If you have installed package ‘ROCR’, <code><a href="../reference/measures.html">measures()</a></code> can provide the Area Under the ROC Curve (AUC) and the maximum of True Skill Statistic (maxTSS) for you. You should simply switch the parameter ‘goodness’ from its default value (<code>FALSE</code>) to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/measures.html">measures</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span>,
         predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_glm</span>,
         evaluation_mask <span class="op">=</span> <span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span>,
         goodness <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;    CP_train     CP_eval         DCP   CPP_train    CPP_eval        DCPP </span>
<span class="co">#&gt;  0.77586207  0.75862069 -0.01724138  0.77192982  0.74074074 -0.03118908 </span>
<span class="co">#&gt;         AUC      maxTSS </span>
<span class="co">#&gt;  0.90517241  0.72515213</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="evaluating-multiple-models">Evaluating multiple models<a class="anchor" aria-label="anchor" href="#evaluating-multiple-models"></a>
</h3>
<p>There is one another <code>logical</code> parameter, called ‘df’, by which you can decide whether a one-row <code>data.frame</code> is more suited for your analysis purposes.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/measures.html">measures</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span>,
         predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">predictions_rf</span>,
         evaluation_mask <span class="op">=</span> <span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span>,
         goodness <span class="op">=</span> <span class="cn">TRUE</span>,
         df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;   CP_train   CP_eval        DCP CPP_train  CPP_eval       DCPP       AUC</span>
<span class="co">#&gt; 1 0.862069 0.6724138 -0.1896552  0.862069 0.6415094 -0.2205595 0.8602941</span>
<span class="co">#&gt;      maxTSS</span>
<span class="co">#&gt; 1 0.7003043</span></code></pre></div>
<p>For example, if you have several models (i.e., two in this example), you can simply <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code> these rows in a <code>for</code> loop or a <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model_IDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"glm"</span>, <span class="st">"rf"</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">model_ID</span> <span class="kw">in</span> <span class="va">model_IDs</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">column_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"predictions_"</span>, <span class="va">model_ID</span><span class="op">)</span>
  <span class="va">conf_and_cons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/measures.html">measures</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span>,
                            predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">[</span>, <span class="va">column_name</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span>,
                            evaluation_mask <span class="op">=</span> <span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span>,
                            df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">model_ID</span> <span class="op">==</span> <span class="va">model_IDs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">conf_and_cons_df</span> <span class="op">&lt;-</span> <span class="va">conf_and_cons</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">conf_and_cons_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">conf_and_cons_df</span>, <span class="va">conf_and_cons</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">conf_and_cons_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">model_IDs</span>
<span class="va">conf_and_cons_df</span>
<span class="co">#&gt;      CP_train   CP_eval         DCP CPP_train  CPP_eval        DCPP</span>
<span class="co">#&gt; glm 0.7758621 0.7586207 -0.01724138 0.7719298 0.7407407 -0.03118908</span>
<span class="co">#&gt; rf  0.8620690 0.6724138 -0.18965517 0.8620690 0.6415094 -0.22055953</span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> solution:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conf_and_cons_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">model_IDs</span>,
                             FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_ID</span><span class="op">)</span> <span class="op">{</span>
                               <span class="va">column_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"predictions_"</span>, <span class="va">model_ID</span><span class="op">)</span>
                               <span class="fu"><a href="../reference/measures.html">measures</a></span><span class="op">(</span>observations <span class="op">=</span> <span class="va">dataset</span><span class="op">$</span><span class="va">occurrences</span>,
                                        predictions <span class="op">=</span> <span class="va">dataset</span><span class="op">[</span>, <span class="va">column_name</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span>,
                                        evaluation_mask <span class="op">=</span> <span class="op">!</span><span class="va">dataset</span><span class="op">$</span><span class="va">training_mask</span>,
                                        df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
                             <span class="op">}</span><span class="op">)</span>
<span class="va">conf_and_cons_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what <span class="op">=</span> <span class="va">rbind</span>,
                            args <span class="op">=</span> <span class="va">conf_and_cons_list</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">conf_and_cons_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">model_IDs</span>
<span class="va">conf_and_cons_df</span>
<span class="co">#&gt;      CP_train   CP_eval         DCP CPP_train  CPP_eval        DCPP</span>
<span class="co">#&gt; glm 0.7758621 0.7586207 -0.01724138 0.7719298 0.7407407 -0.03118908</span>
<span class="co">#&gt; rf  0.8620690 0.6724138 -0.18965517 0.8620690 0.6415094 -0.22055953</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ákos Bede-Fazekas, Imelda Somodi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
